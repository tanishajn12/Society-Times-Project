<%- include('../partials/header') %>
<%- include('../partials/navbar') %>
<%- include('../partials/flash') %>

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-body">
                    <h2 class="card-title text-center mb-4">Edit Event Details</h2>
                    <form class="needs-validation" action="/events/<%= foundEvent._id %>?_method=PATCH" method="POST" novalidate>
                        <div class="mb-3">
                            <label for="eventName" class="form-label">Event Name</label>
                            <input type="text" class="form-control" name="name" id="eventName" value="<%= foundEvent.name %>" placeholder="Name of Event" required>
                            <div class="valid-feedback">Looks good!</div>
                            <div class="invalid-feedback">Please enter an event name.</div>
                        </div>

                        <div class="mb-3">
                            <label for="eventImage" class="form-label">Image URL</label>
                            <input type="url" class="form-control" name="img" id="eventImage" placeholder="Image URL of Event" value="<%= foundEvent.img %>">
                            <div class="valid-feedback">Looks good!</div>
                            <div class="invalid-feedback">Please enter an image URL.</div>
                        </div>

                        <div class="mb-3">
                            <label for="eventDate" class="form-label">Event Date</label>
                            <input type="date" class="form-control" name="date" id="eventDate" value="<%= foundEvent.date.toISOString().split('T')[0] %>" required>
                            <div class="valid-feedback">Looks good!</div>
                            <div class="invalid-feedback">Please choose an event date.</div>
                        </div>

                        <div class="mb-3">
                            <label for="eventTime" class="form-label">Event Time</label>
                            <input type="time" class="form-control" name="time" id="eventTime" placeholder="Time of Event" value="<%= foundEvent.time %>" required>
                            <div class="valid-feedback">Looks good!</div>
                            <div class="invalid-feedback">Please enter an event time.</div>
                        </div>

                        <div class="mb-3">
                            <label for="eventSociety" class="form-label">Society</label>
                            <select class="form-control" name="society" id="eventSociety" required>
                                <option value="">Select Society</option>
                                <% societies.forEach(society => { %>
                                    <option value="<%= society._id %>" <%= foundEvent.society.toString() === society._id.toString() ? 'selected' : '' %>><%= society.name %></option>
                                <% }); %>
                            </select>
                            <div class="valid-feedback">Looks good!</div>
                            <div class="invalid-feedback">Please select a society.</div>
                        </div>

                        <div class="mb-3">
                            <label for="eventVenue" class="form-label">Venue</label>
                            <input type="text" class="form-control" name="venue" id="eventVenue" placeholder="Venue of Event" value="<%= foundEvent.venue %>" required>
                            <div class="valid-feedback">Looks good!</div>
                            <div class="invalid-feedback">Please enter the event venue.</div>
                        </div>

                        <div class="mb-3">
                            <label for="eventType" class="form-label">Type</label>
                            <input type="text" class="form-control" name="type" id="eventType" placeholder="Type of Event" value="<%= foundEvent.type %>" required>
                            <div class="valid-feedback">Looks good!</div>
                            <div class="invalid-feedback">Please enter the event type.</div>
                        </div>

                        <div class="mb-3">
                            <label for="eventDesc" class="form-label">Description</label>
                            <textarea class="form-control" name="desc" id="eventDesc" rows="5" placeholder="Description of Event" required><%= foundEvent.desc %></textarea>
                            <div class="valid-feedback">Looks good!</div>
                            <div class="invalid-feedback">Please enter a description.</div>
                        </div>

                        <div class="mb-3">
                            <label for="registerLink" class="form-label">Registration Link</label>
                            <input type="url" class="form-control" name="registerLink" id="registerLink" placeholder="Registration Link for Event" value="<%= foundEvent.registerLink %>">
                            <div class="valid-feedback">Looks good!</div>
                            <div class="invalid-feedback">Please enter a registration link.</div>
                        </div>

                        <button type="submit" class="btn btn-primary">Save Changes</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<%- include('../partials/footer') %>
